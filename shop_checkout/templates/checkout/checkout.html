{% extends "base.html" %}
{% load static %}

{% block page_header %}
    <div class="container header-container">
        <div class="row">
            <div class="col"></div>
        </div>
    </div>
{% endblock %}

{% block content %}


<!--- Template was copied from Bootstrap templates -->
<div class="row">
  <div class="col-md-4 order-md-2 mb-4">
    <h4 class="d-flex justify-content-between align-items-center mb-3">
      <span class="text-muted">Your cart</span>
      <span class="badge badge-secondary badge-pill">{{ total_quantity }}</span>
    </h4>

    {% for unit in cart %}
    {% with item=unit.item %}

    <div class="list-group mb-3">

     
        <div data-index="{{item.id}}" class="row mb-4 border single-item">
          <div class="col-md-3 col-lg-2 order-md-first">
            <img class="img-fluid mx-auto d-block" width="200px" alt="Responsive image" src="{{ item.image_url }}">
          </div>
          <div class="col-md-5 col-12">
            <h2 class="mb-o h-4">{{ item.name }}</h2>

            <div>
              <div>
                <label>Size: {{unit.size}}</label>
                <label for="select">Quantity: {{unit.quantity}}</label>
              </div>
              <p id="subtotal">Â£ {{ unit.item_total }}</p>
            </div>
          </div>
        </div>
      </div>
            {% endwith %}
            {% endfor %}

            <div class="list-group-item d-flex justify-content-between">
              <span>Total (GBP)</span>
              <strong>
                <div id="total" class="d-inline-flex">{{cart.unit_total}}</div>
              </strong>
            </div>
         
        
  </div>
  <div class="col-md-8 order-md-1">
    <h4 class="mb-3">Billing address</h4>
    <form id="payment-form">
      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="firstName">First name</label>
          <input type="text" class="form-control" id="firstName" placeholder="" value="" required>
          <div class="invalid-feedback">
            Valid first name is required.
          </div>
        </div>
        <div class="col-md-6 mb-3">
          <label for="lastName">Last name</label>
          <input type="text" class="form-control" id="lastName" placeholder="" value="" required>
          <div class="invalid-feedback">
            Valid last name is required.
          </div>
        </div>
      </div>

      <div class="mb-3">
        <label for="username">Username</label>
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">@</span>
          </div>
          <input type="text" class="form-control" id="username" placeholder="Username" required>
          <div class="invalid-feedback" style="width: 100%;">
            Your username is required.
          </div>
        </div>
      </div>

      <div class="mb-3">
        <label for="email">Email <span class="text-muted">(Optional)</span></label>
        <input type="email" class="form-control" id="email" placeholder="your@emailaddress.com">
        <div class="invalid-feedback">
          Please enter a valid email address for shipping updates.
        </div>
      </div>

      <div class="mb-3">
        <label for="addressLine">Address Line 1</label>
        <input type="text" class="form-control" id="addressLine" placeholder="1234 Whale St" required>
        <div class="invalid-feedback">
          Please enter your shipping address.
        </div>
      </div>

      <div class="mb-3">
        <label for="addressLine2">Address Line 2 <span class="text-muted">(Optional)</span></label>
        <input type="text" class="form-control" id="addressLine2" placeholder="Apartment or suite">
      </div>

      <div class="row">
        <div class="col-md-5 mb-3">
          <label for="country">Country</label>
          <select class="custom-select d-block w-100" id="country" required>
            <option value="">Choose...</option>
            <option>United States</option>
          </select>
          <div class="invalid-feedback">
            Please select a valid country.
          </div>
        </div>
        <div class="col-md-4 mb-3">
          <label for="state">State</label>
          <select class="custom-select d-block w-100" id="state" required>
            <option value="">Choose...</option>
            <option>California</option>
          </select>
          <div class="invalid-feedback">
            Please provide a valid state.
          </div>
        </div>
        <div class="col-md-3 mb-3">
          <label for="postCode">Post Code</label>
          <input type="text" class="form-control" id="postCode" placeholder="" required>
          <div class="invalid-feedback">
            Zip code required.
          </div>
        </div>
      </div>
      <!--- Error message in card -->
      <div class="d-block my-3">
        <h4 mb-3>Payment</h4>
        <label for="card-element">Card Details</label>

        <div id="card-element" class="form-control form-control-payment"></div>
        <div id="card-errors" role="alert"></div>
      </div>

      <hr class="mb-4">
      <button class="btn btn-primary btn-lg btn-block" data-secret="{{ clinet_secret }}" id="submit"
        type="submit">Pay</button>
    </form>
  </div>
</div>
    

<script>
    var CSRF_TOKEN = '{{ csrf_token }}';
</script>
<!---Script was copied from offical documentation-->
<script src="https://js.stripe.com/v3/"></script>

<script src="{% static 'stripe/stripe.js' %}" data-rel-js></script>
{% endblock %}